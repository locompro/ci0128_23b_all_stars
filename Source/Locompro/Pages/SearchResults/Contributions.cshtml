@page
@using System.Net;
@using Castle.Core.Internal;
@using Locompro.Common;
@using Locompro.Common.Mappers;
@using Locompro.Common.Search;
@using Locompro.Common.Search.SearchMethodRegistration;
@using Locompro.Models.Dtos;
@using Locompro.Models.ViewModels;
@using Locompro.Pages.Shared;
@using Locompro.Services;
@using Locompro.Models.Entities
@model Locompro.Pages.SearchResults.ContributionsPageModel

<link rel="stylesheet" href="~/css/SearchResults.css" asp-append-version="true"/>
<div class="container"> 
    <h2>Mis Contribuciones</h2>
    <h6> @Model.DisplayAmount contribuciones totales </h6>
        <div class="table-encapsulate-for-results">
            <table class="table table-hover search-results-table">
                <thead>
                    <tr>
                        <th scope="col">Fecha de aporte </th>
                        <th scope="col">Producto</th>
                        <th scope="col">Modelo</th>
                        <th scope="col">Marca</th>
                        <th scope="col">Descripción</th>
                        <th scope="col">Precio</th>
                        <th scope="col">Rating</th>
                        <th scope="col">Tienda</th>
                        <th scope="col">Provincia</th>
                        <th scope="col">Canton</th>
                    </tr>
                </thead>
                <tbody>
                @{
                    PaginatedList<ItemVm> items = Model.DisplaySubmissions;
                    foreach (ItemVm item in items)
                    {
                        foreach (SubmissionVm submission in item.Submissions)
                        {
                            <tr>
                            <td>
                                @Html.DisplayFor(modelSubmission => submission.EntryTime)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => item.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => item.Model)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => item.Brand)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => submission.Description)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => submission.Price)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => submission.Rating)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => item.Store)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => item.Province)
                            </td>
                            <td>
                                @Html.DisplayFor(modelSubmission => item.Canton)
                            </td>
                        </tr>
                        }
                    }
                 }
                </tbody>
            </table>
        </div>
        @{
            var prevDisabled = !Model.DisplaySubmissions.HasPreviousPage ? "disabled" : "";
            var nextDisabled = !Model.DisplaySubmissions.HasNextPage ? "disabled" : "";
        }
        <div class="previous-next-button-area">
            <a asp-page=""
                asp-route-query=@Model.CurrentUserId
                asp-route-pageIndex="@(Model.DisplaySubmissions.PageIndex - 1)"
                class="btn btn-primary @prevDisabled">
                Previo
            </a>
            <input type="number"
                    class="number-input-pages"
                    min=1
                    max="@Model.DisplaySubmissions.TotalPages"
                    value="@Model.DisplaySubmissions.PageIndex"
                    onchange="changeIndexPage(this)">
            <a asp-page=""
                asp-route-query=@Model.CurrentUserId
                asp-route-pageIndex="@(Model.DisplaySubmissions.PageIndex + 1)"
                class="btn btn-primary @nextDisabled">
                Siguiente
            </a>
            <h6 class="page-amount-text"> @Model.DisplaySubmissions.TotalPages páginas de resultados </h6>
        </div>
</div>