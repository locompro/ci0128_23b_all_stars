@page
@model Locompro.Pages.Account.ProfileModel
@{
    ViewData["Title"] = "Perfil";
    Layout = "~/Pages/Shared/_Layout.cshtml";
}

<div class="text-center d-lg-flex justify-content-lg-center">
    
    <div class="container flex-shrink-1 flex-fill justify-content-center align-items-center align-content-center ">
        <div class="row">
            <div class="col d-lg-flex justify-content-lg-center">
                <div class="bs-icon-xl bs-icon-circle bs-icon-primary text-center d-inline-flex d-lg-flex bs-icon my-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-person-fill text-center d-lg-flex justify-content-lg-center" style="font-size: 40px;">
                        <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"></path>
                    </svg>
                </div>
            </div>
        </div>
        <div class="row" style="margin-bottom: 30px">
            <div class="col">
                <h2 class="d-xxl-flex justify-content-xxl-center">@Model.UserProfile.Username</h2>
                <h4 class="text-secondary">@Model.UserProfile.Name</h4>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <h4>Correo</h4>
                <p class="d-xl-flex justify-content-xl-center">@Model.UserProfile.Email</p>
            </div>
        </div>
        <div class="row d-xl-flex justify-content-xl-center">
            <div class="col-xl-7">
                <h4>Dirección</h4>
                s
            </div>
        </div>
        <div class="row">
            <div class="col justify-content-right">
                <div class="text-center d-flex flex-column justify-content-center align-items-center py-3" style="margin-right: 0px">
                    <div class="bs-icon-md bs-icon-circle bs-icon-primary d-flex flex-shrink-0 justify-content-center align-items-center d-inline-block mb-2 bs-icon lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-journal-check" style="font-size: 32px;">
                            <path fill-rule="evenodd" d="M10.854 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 8.793l2.646-2.647a.5.5 0 0 1 .708 0z"></path>
                            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"></path>
                            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"></path>
                        </svg>
                    </div>
                    <div class="px-3">
                        <h4 class="fw-bold mb-0">@Model.UserProfile.Contributions</h4>
                        <p class="mb-0">Contribuciones</p>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="text-center d-flex flex-column justify-content-center align-items-center py-3" style="margin-left: 0px">
                    <div class="bs-icon-md bs-icon-circle bs-icon-primary d-flex flex-shrink-0 justify-content-center align-items-center d-inline-block mb-2 bs-icon lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-star-fill">
                            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"></path>
                        </svg>
                    </div>
                    <div class="px-3">
                        <h4 class="fw-bold mb-0">@Model.UserProfile.Rating</h4>
                        <p class="mb-0">Calificación</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col d-xxl-flex justify-content-xxl-end">
                <button class="btn btn-primary border rounded-pill d-xxl-inline-flex" style="padding-left: 31px;padding-right: 31px;" type="button" data-bs-target="#modal-2" data-bs-toggle="modal">Modificar Perfil</button>
            </div>
            <div class="col">
                <button class="btn btn-primary text-center border rounded-pill d-xxl-flex flex-grow-0 flex-shrink-1 justify-content-xxl-start" type="button" data-bs-target="#modal-1" data-bs-toggle="modal">Cambiar Contraseña</button>
            </div>
        </div>
        @if (Model.IsPasswordChanged)
        {
            <div class= "row justify-content-center align-items-center align-content-center" style="margin-top: 20px; margin-bottom: 20px">
                <div id="passwordChangedAlert" class="alert alert-success alert-dismissible fade show" role="alert" style="display: block;">
                    ¡Contraseña cambiada exitosamente!
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            </div>
        }
        <!-- Modals -->
        <div class="modal fade" role="dialog" tabindex="-1" id="modal-1">
            <div class="modal-dialog" role="document">
                <div class="modal-content" style="border-radius: 15px; padding-top: 5px; padding-bottom: 10px; padding-left: 8px; padding-right: 6px">
                    <div class="modal-header">
                        <h4 class="modal-title text-center d-xxl-flex justify-content-xxl-center">Cambia Mi Contraseña</h4><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form method="post" asp-page-handler="ChangePassword">
                            <div asp-validation-summary="All" class="text-danger"></div>

                            <div class="row">
                                <div class="col">
                                    <label class="form-label d-xxl-flex justify-content-xxl-start">Actual Contraseña</label>
                                    <input class="form-control" type="password" asp-for="PasswordChange.CurrentPassword" required>
                                    <span asp-validation-for="PasswordChange.CurrentPassword" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label class="form-label d-xxl-flex justify-content-xxl-start">Nueva Contraseña</label>
                                    <input class="form-control" asp-for="PasswordChange.NewPassword">
                                    <span asp-validation-for="PasswordChange.NewPassword" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label class="form-label d-xxl-flex justify-content-xxl-start">Digite la nueva contraseña una vez más</label>
                                    <input class="form-control"asp-for="PasswordChange.ConfirmNewPassword">
                                    <span asp-validation-for="PasswordChange.ConfirmNewPassword" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="modal-footer">
                                <button class="btn btn-light" type="reset" data-bs-dismiss="modal">Cancelar</button>
                                <button class="btn btn-primary" type="submit">Cambiar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>


        <div class="modal fade" role="dialog" tabindex="-1" id="modal-2">
            <div class="modal-dialog" role="document">
                <div class="modal-content" style="border-radius: 15px; padding-top: 5px; padding-bottom: 10px; padding-left: 8px; padding-right: 6px">
                    <div class="modal-header">
                        <h4 class="modal-title">Modificar Mi Perfil</h4><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="row">
                                <div class="col">
                                    <label class="form-label d-xxl-flex justify-content-xxl-start">Correo Electrónico</label><input class="form-control" type="text" inputmode="email">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label class="form-label d-xxl-flex justify-content-xxl-start">Provincia</label><input class="form-control" type="text" autocomplete="on"><label class="form-label d-xxl-flex justify-content-xxl-start">Cantón</label><input class="form-control" type="text" autocomplete="on"><label class="form-label d-xxl-flex justify-content-xxl-start">Dirección exacta</label><input class="form-control" type="text">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-light" type="button" data-bs-dismiss="modal">Cancelar</button><button class="btn btn-primary" type="submit">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @section Scripts {
        <script>
        $(document).ready(
            function() {
                let HasErrorsInChangePasswordModal = @Model.HasErrorsInChangePasswordModal.ToString().ToLower();
                if (HasErrorsInChangePasswordModal) {
                    $('#modal-1').modal('show');
                }
            }
        );
       
        function showPasswordChangedAlert() {
            document.getElementById("passwordChangedAlert").style.display = "block";
        }

    </script>
        <script src="assets/bootstrap/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/jquery.tablesorter.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/widgets/widget-filter.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/widgets/widget-storage.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <script src=""></script>
        <script src="lib/jquery-validation/dist/jquery.validate.min.js"></script>
        <script src="lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
        <script src="lib/jquery/jquery.min.js"></script>
    }

</div>